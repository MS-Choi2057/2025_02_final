/* 기본 설정: body가 배경 이미지를 담당합니다 */
body {
    background-color: #111;
    color: #eee;
    font-family: 'KoPub Batang', 'Georgia', serif;
    background-position: center center;
    background-size: cover;
    background-attachment: fixed;
    background-repeat: no-repeat;
    transition: background-image 0.8s ease-in-out;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    text-align: center;
    overflow-x: hidden;
    margin: 0;
    position: relative;
}

body.back-1 { background-image: url('back1.png'); }
body.back-2 { background-image: url('back2.png'); }

/* 날아다니는 캐릭터 스타일 */
.flying-character {
    position: absolute;
    width: 200px;
    height: auto;
    animation: fly 20s linear infinite;
    z-index: 1;
    pointer-events: none;
}

.flying-character:nth-child(1) { top: 10%; left: -20%; animation-delay: 0s; animation-duration: 25s; }
.flying-character:nth-child(2) { top: 40%; left: -30%; animation-delay: 5s; animation-duration: 30s; }
.flying-character:nth-child(3) { top: 70%; left: -10%; animation-delay: 10s; animation-duration: 20s; }

@keyframes fly {
    0% { transform: translateX(0) scaleX(1); opacity: 0; }
    10% { opacity: 1; }
    45% { transform: translateX(120vw) scaleX(1); opacity: 1; }
    50% { transform: translateX(120vw) scaleX(-1); opacity: 0; }
    60% { opacity: 1; }
    95% { transform: translateX(0) scaleX(-1); opacity: 1; }
    100% { transform: translateX(0) scaleX(-1); opacity: 0; }
}

/* 스테이지 박스 스타일 */
.stage {
    display: none; 
    width: 90%;
    max-width: 700px;
    padding: 50px 30px;
    background-color: rgba(20, 20, 20, 0.85);
    border: 1px solid #444;
    border-radius: 15px;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
    z-index: 2;
}

.stage.active {
    display: block;
    animation: fadeIn 1s;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

h1 { color: #FFD700; font-weight: 700; text-shadow: 0 0 10px #FFD700; margin-bottom: 10px; }
h2 { color: #aaa; font-size: 1.2em; margin-top: 0; margin-bottom: 40px; }
p { font-size: 1.1em; line-height: 1.8; color: #ddd; }

/* 인트로 로고 애니메이션 */
.logo-area {
    font-size: 6em;
    margin-bottom: 20px;
    animation: float 3s ease-in-out infinite;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
}

@keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
    100% { transform: translateY(0px); }
}

/* 버튼 스타일 */
.next-btn, button {
    background-color: #FFD700;
    color: #111;
    border: none;
    padding: 15px 30px;
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    border-radius: 5px;
    margin-top: 40px;
    transition: all 0.3s ease;
}
button:disabled { background-color: #555; color: #888; cursor: not-allowed; box-shadow: none; }
button:hover:not(:disabled) { background-color: #fff; box-shadow: 0 0 20px #FFD700; transform: scale(1.05); }

/* 1단계: 참회의 방 */
.idol-container { display: flex; justify-content: space-around; margin-top: 40px; }
.idol { background-color: #333; color: #ccc; font-size: 1.5em; border: 2px solid #555; padding: 15px; border-radius: 10px; transition: all 0.2s; }
.idol:hover { border-color: #FFD700; }
.idol.destroyed { background-color: #111; color: #444; text-decoration: line-through; border-color: #8b0000; pointer-events: none; transform: scale(0.9); }
.feedback { margin-top: 20px; font-style: italic; color: #FFD700; font-weight: bold; }

/* --- [변경됨] 2단계: 캐릭터와 말풍선 스타일 --- */
.dialogue-area {
    display: flex;
    align-items: flex-start;
    justify-content: center;
    gap: 20px;
    margin-bottom: 30px;
}

.stage-char {
    width: 120px;
    height: 120px;
    object-fit: cover;
    border-radius: 50%;
    border: 4px solid #FFD700;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    background-color: #000;
}

.speech-bubble {
    position: relative;
    background: #fff;
    color: #111;
    padding: 20px 25px;
    border-radius: 20px;
    text-align: left;
    max-width: 400px;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
}

/* 말풍선 꼬리 */
.speech-bubble::after {
    content: '';
    position: absolute;
    left: -15px;
    top: 30px;
    border-width: 15px 15px 15px 0;
    border-style: solid;
    border-color: transparent #fff transparent transparent;
}

/* 말풍선 안의 텍스트 재정의 (가독성) */
.speech-bubble h1 {
    color: #d32f2f; /* 피의 서약 느낌의 붉은색 */
    font-size: 1.5em;
    text-shadow: none;
    margin-bottom: 5px;
}
.speech-bubble p {
    color: #333;
    font-weight: bold;
    margin: 0;
    font-size: 1em;
}

/* 서약 입력 그룹 */
.oath-group {
    text-align: center;
    margin-bottom: 25px;
    animation: slideIn 0.5s ease-out;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateX(20px); }
    to { opacity: 1; transform: translateX(0); }
}

.oath-group label { display: block; margin-bottom: 15px; color: #FFD700; font-size: 1.1em; font-style: italic; line-height: 1.4;}

.oath-input {
    width: 100%;
    padding: 12px;
    box-sizing: border-box;
    background-color: #222;
    border: 2px solid #555;
    color: #FF6347; 
    font-size: 1.1em;
    border-radius: 5px;
    outline: none;
    text-align: center; /* 중앙 정렬 */
}
.oath-input:focus { border-color: #FF6347; }
.oath-input.success { border-color: #FFD700; background-color: rgba(255, 215, 0, 0.1); color: #FFD700; }
.oath-input.error { border-color: #8b0000; animation: shake 0.3s; }

@keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
    100% { transform: translateX(0); }
}

/* 3단계 & 성소 */
#new-name { color: #FFD700; font-size: 3em; font-weight: bold; text-shadow: 0 0 30px #FFD700; margin: 40px 0; }
#welcome-message { color: #FFD700; text-shadow: 0 0 10px #FFD700; }
.sanctuary-content { text-align: left; margin-top: 40px; border-top: 1px solid #555; padding-top: 30px; }